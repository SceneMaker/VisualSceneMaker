(this["webpackJsonpreact-studymaster"]=this["webpackJsonpreact-studymaster"]||[]).push([[0],{132:function(e,t,n){},133:function(e,t,n){},144:function(e,t,n){"use strict";n.r(t);var c=n(24),i=n.n(c),a=(n(132),n(3)),s=n(11),r=n(12),o=n(0),l=(n(133),n(134),n(225)),d=n(90),j=n.n(d),b=n(219),u=n(211),h=n(229),m=n(231),p=n(207),O=n(227),x=n(230),f=n(226),v=n(228),S=n(6),g=n(89),y=n(1),C=Object(S.a)(p.a)((function(e){var t,n=e.theme;return t={},Object(a.a)(t,"&.".concat(g.a.head),{backgroundColor:n.palette.common.black,color:n.palette.common.white}),Object(a.a)(t,"&.".concat(g.a.body),{fontSize:14}),Object(a.a)(t,"&.".concat(g.a.root),{borderBottom:"none"}),t})),w=Object(S.a)(f.a)((function(e){return{"&:nth-of-type(odd)":{backgroundColor:e.theme.palette.action.hover},"&:last-child td, &:last-child th":{border:0}}})),k=function(e){return Object(y.jsx)(O.a,{component:v.a,children:Object(y.jsxs)(h.a,{sx:{},size:"small","aria-label":"simple table",children:[Object(y.jsx)(x.a,{children:Object(y.jsx)(w,{children:e.colNames.map((function(e,t){return Object(y.jsx)(C,{children:e},t)}))})}),Object(y.jsx)(m.a,{children:Object.keys(e.colVals).map((function(t,n){return Object(y.jsxs)(w,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(y.jsx)(C,{component:"th",scope:"row",children:t}),e.colVals[t].map((function(e,t){return Object(y.jsx)(C,{children:e},t)}))]},n)}))})]})})},F=n(111),D=n.n(F),N=function(e){var t=Object(o.useState)(!1),n=Object(r.a)(t,2),c=n[0],i=n[1];return Object(y.jsxs)("div",{className:"sidebar-divider",children:[Object(y.jsx)("div",{className:"button-area",children:Object(y.jsxs)(l.a,{onClick:function(){e.setCollapseDevToolComp(!e.collapseDevToolComp),i(!c)},"aria-controls":"example-collapse-text","aria-expanded":c,children:[c&&Object(y.jsxs)("div",{children:[Object(y.jsx)(j.a,{})," Developer Tools"]}),!c&&Object(y.jsx)(b.a,{disableFocusListener:!0,title:"Developer Tools",children:Object(y.jsx)(j.a,{})})]})}),Object(y.jsx)("div",{className:"variable-list",children:Object(y.jsxs)(u.a,{in:c,dimension:"width",children:[Object(y.jsx)("hr",{}),Object(y.jsxs)("div",{children:[Object(y.jsx)("h3",{children:"VSM Variable List"}),Object(y.jsx)("hr",{}),Object(y.jsx)("div",{className:c?"logbox":"",style:{height:"35vh",color:"white"},children:Object(y.jsx)(k,{colNames:["Variables","Value"],colVals:e.vsmVars})})]})]})}),Object(y.jsx)("div",{className:"log",children:Object(y.jsxs)(u.a,{in:c,dimension:"width",children:[Object(y.jsx)("hr",{}),Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{className:"flex-container",children:[Object(y.jsx)("div",{className:"item1",children:Object(y.jsx)("h3",{children:"Log history"})}),Object(y.jsx)("div",{className:"item2",children:Object(y.jsxs)(l.a,{variant:"secondary",onClick:function(){console.log("Downloading...");var t=e.infoLogContents,n=[];Object.keys(t).forEach((function(e){n.push([e,t[e].join(",")].join(","))}));var c=[["Timestamp","InformCmd"].join(",")].concat(n).join("\r\n"),i=new Blob([c],{type:"application/csv"}),a=URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download="StudyMasterInformCmds.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s)},children:[Object(y.jsx)(D.a,{})," Download logs"]})})]}),Object(y.jsx)("hr",{}),Object(y.jsx)("div",{className:c?"logbox":"",style:{height:"35vh",color:"white"},children:Object(y.jsx)(k,{colNames:["Timestamp","InformCmd"],colVals:e.infoLogContents})})]})]})})]})},T=n(17),E=n(212),I=n(215),U=n(233),V=n(220),M=n(221),R=n(232),L=n(223),B=n(217),A=n(216);var P=function(e,t,n,c,i){var l=n.variable[c],d=n.options[c].split(","),j=Object(o.useState)(d.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(a.a)({},t,!1))}),{})),b=Object(r.a)(j,2),u=b[0],h=b[1];function m(e,t){if("undefined"===typeof e)return!1;for(var n=e.length;n--;)if(e[n]===t)return!0;return!1}return Object(y.jsxs)("div",{children:["text"===n.type[c]&&Object(y.jsxs)(E.a,{style:{marginTop:"30px",marginBottom:"30px"},children:[Object(y.jsx)(L.a,{color:"primary",focused:!0,htmlFor:l,style:{marginBottom:"10px"},children:n.variable[c]}),Object(y.jsx)(I.a,Object(s.a)({variant:"standard",name:l,label:n.options[c],value:e.userSubmittedInfo[l]||"",id:l,onChange:function(e){t(l,e.target.value)}},i[l]&&{error:!0,helperText:i[l]}))]}),"number"===n.type[c]&&Object(y.jsxs)(E.a,{style:{marginTop:"30px",marginBottom:"30px"},children:[Object(y.jsx)(L.a,{color:"primary",focused:!0,htmlFor:l,style:{marginBottom:"10px"},children:n.variable[c]}),Object(y.jsx)(I.a,Object(s.a)({type:"number",style:{width:"150px"},name:l,InputProps:{inputProps:{min:0,max:1e3}},label:n.options[c],id:l,value:e.userSubmittedInfo[l]||"",onChange:function(e){return t(l,e.target.value)}},i[l]&&{error:!0,helperText:i[l]}))]}),"radio"===n.type[c]&&Object(y.jsxs)(E.a,{style:{marginTop:"30px",marginBottom:"30px"},children:[Object(y.jsx)(L.a,{color:"primary",focused:!0,htmlFor:l,style:{marginBottom:"10px"},children:n.variable[c]}),Object(y.jsx)(E.a,{children:Object(y.jsx)(R.a,{error:void 0!==i[l],children:Object(y.jsxs)(V.a,{"aria-label":n.variable[c],name:"radio-buttons-group",children:[d.map((function(n){return Object(y.jsx)(A.a.Check,{name:"group1",type:"radio",label:n,value:n||"",checked:e.userSubmittedInfo[l]===n||!1,onChange:function(e){t(l,e.target.value)}},n)})),Object(y.jsx)(U.a,{children:i[l]})]})})})]}),"checkbox"===n.type[c]&&Object(y.jsxs)(E.a,{style:{marginTop:"30px",marginBottom:"30px"},children:[Object(y.jsx)(L.a,{color:"primary",focused:!0,htmlFor:l,style:{marginBottom:"10px"},children:n.variable[c]}),Object(y.jsxs)(R.a,{error:void 0!==i[l],children:[d.map((function(n){return Object(y.jsx)(M.a,{label:n,control:Object(y.jsx)(B.a,{defaultValue:!1,name:n,color:"default",checked:m(e.userSubmittedInfo[l],n),onChange:function(e){!function(e,n){var c=Object(s.a)(Object(s.a)({},u),{},Object(a.a)({},n.target.name,n.target.checked));h(c);var i=Object.keys(c).filter((function(e){return!0===c[e]}));t(e,i)}(l,e)}})},n)})),Object(y.jsx)(U.a,{children:i[l]})]})]})]})};var z=function(e){var t=[];if(e.inputSheetFieldDetails&&"REQUEST"===e.inputSheetFieldDetails.action)for(var n=0;n<e.inputSheetFieldDetails.variable.length;n++){var c=P(e,e.updateUserSubmittedInfo,e.inputSheetFieldDetails,n,e.formFillingErrors);t.push(c)}return Object(y.jsx)("div",{children:t.map((function(e,t){return Object(y.jsx)("div",{children:e},t)}))})},Q=n(218),q=n(224),W=n(214),_=n(113),J=n.n(_),H=n(112),Y=n.n(H);var $,G=function(e){var t=Object(o.useState)({}),n=Object(r.a)(t,2),c=n[0],i=n[1];function a(){if(0===e.userSubmittedInfo.size){var t=Object(T.a)(e.inputSheetFieldDetails.variable).sort(),n={};return t.forEach((function(e){n[e]="Please fill "+e})),i(n),!1}if(Object(T.a)(Object.keys(e.userSubmittedInfo)).length>0){for(var c=[],a=0;a<e.inputSheetFieldDetails.variable.length;a++)"checkbox"!==e.inputSheetFieldDetails.type[a]&&c.push(e.inputSheetFieldDetails.variable[a]);var s=[].concat(c).sort(),r=Object(T.a)(Object.keys(e.userSubmittedInfo)).sort();r=r.filter((function(t){return""!==e.userSubmittedInfo[t]}));var o=s.filter((function(e){return!r.includes(e)})),l={};if(o.forEach((function(e){l[e]="Please fill "+e})),i(l),0===o.length)return!0}}return Object(y.jsxs)("div",{className:"input-sheet-unit-divider",children:[Object(y.jsx)("form",{style:{marginLeft:"1vw"},children:Object(y.jsx)("div",{className:"in-form-fields",children:Object(y.jsxs)("fieldset",{children:[e.inputSheetFieldDetails&&"REQUEST"===e.inputSheetFieldDetails.action,Object(y.jsx)(z,{userSubmittedInfo:e.userSubmittedInfo,setUserSubmittedInfo:e.setUserSubmittedInfo,updateUserSubmittedInfo:e.updateUserSubmittedInfo,inputSheetFieldDetails:e.inputSheetFieldDetails,validateForm:a,formFillingErrors:c}),e.inputSheetFieldDetails&&"SUCCESSFULSEND"===e.inputSheetFieldDetails.action&&Object(y.jsx)("div",{children:Object(y.jsx)("h2",{style:{color:"green"},children:"Successfully posted!"})})]})})}),Object(y.jsx)("form",{children:Object(y.jsxs)("div",{className:"in-form-buttons",children:[e.inputSheetFieldDetails&&"REQUEST"===e.inputSheetFieldDetails.action&&Object(y.jsx)(q.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",children:Object(y.jsx)(q.a,{item:!0,xs:2,children:Object(y.jsxs)(W.a,{direction:"row",spacing:2,style:{textAlign:"center"},children:[Object(y.jsx)(Q.a,{style:{borderRadius:35,backgroundColor:"green",padding:"18px 36px",fontSize:"18px",width:"15vw"},variant:"contained",onClick:function(){a()&&e.sendSubmit()},startIcon:Object(y.jsx)(Y.a,{}),children:" Submit"}),Object(y.jsx)(Q.a,{style:{borderRadius:35,backgroundColor:"red",padding:"18px 36px",fontSize:"18px",width:"15vw"},variant:"contained",color:"error",onClick:e.sendCancel,startIcon:Object(y.jsx)(J.a,{}),children:" Cancel"})]})})}),!(e.inputSheetFieldDetails&&"REQUEST"===e.inputSheetFieldDetails.action)&&Object(y.jsx)("div",{children:Object(y.jsx)("p",{style:{color:"white"},children:"No active requests."})})]})})]})},K=n(114),X=n.n(K),Z=n(115),ee=n.n(Z);var te=function(){var e=Object(o.useState)(!1),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(o.useState)({}),l=Object(r.a)(i,2),d=l[0],j=l[1],u=Object(o.useState)(""),h=Object(r.a)(u,2),m=h[0],p=h[1],O=Object(o.useState)(),x=Object(r.a)(O,2),f=x[0],v=x[1],S=Object(o.useState)(!0),g=Object(r.a)(S,2),C=g[0],w=g[1],k=Object(o.useState)({}),F=Object(r.a)(k,2),D=F[0],T=F[1],E=Object(o.useState)({}),I=Object(r.a)(E,2),U=I[0],V=I[1];function M(){$.readyState===WebSocket.OPEN&&($.send("VSMMessage#STATUS#alive"),setTimeout(M,100))}return Object(o.useEffect)((function(){console.log("Setting up web socket...");var e=$=new WebSocket("ws://"+document.location.host+"/ws");e.onopen=function(){c(!0),M(),console.log("Connection initiated by server.")},e.onclose=function(e){console.log(e),c(!1),j({}),V({}),v({}),p("");var t="VSM is not in 'play' state anymore. Please press 'play' in VSM and refresh the page.";console.log(t),p(t)},e.onmessage=function(e){var t=e.data.split("#"),n=t[1];if(["REQUEST","INFORM","UPDATE","STATUS"].includes(n)){if("REQUEST"===n){var i={action:n,variable:t[3].split(";"),options:t[4].split(";"),type:t[5].split(";"),timestamp:t[2]};v(i);var r=i.variable.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(a.a)({},t,""))}),{});V(r)}if("INFORM"===n){var o={};o[function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"_"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}()]=[t[4]],p(t[4]),j(Object.assign(d,o))}if("UPDATE"===n){var l=t[2],b=t[3],u={};u[l]=[b],T(Object.assign(D,u))}"STATUS"===n&&console.log()}else console.log("Unknown command: "+n);c(!0)},document.title="VSM StudyMaster";var t=document.querySelector("link[rel*='icon']")||document.createElement("link");return t.type="image/x-icon",t.rel="shortcut icon",t.href="http://scenemaker.dfki.de/images/scenemaker/logo.png",document.getElementsByTagName("head")[0].appendChild(t),function(){e.disconnect()}}),[]),Object(y.jsx)("div",{className:"App",children:Object(y.jsxs)("div",{className:C?"wrapper-collapsed":"wrapper",children:[Object(y.jsx)("div",{className:"header box",children:Object(y.jsxs)("div",{className:"flex-container",children:[Object(y.jsx)("div",{className:"item1",children:Object(y.jsx)("h1",{children:"Studymaster"})}),Object(y.jsx)("div",{className:"item2",children:n?Object(y.jsx)(b.a,{disableFocusListener:!0,title:"VSM connected",children:Object(y.jsx)(X.a,{style:{fill:"green",fontSize:50}})}):Object(y.jsx)(b.a,{disableFocusListener:!0,title:"VSM not connected",children:Object(y.jsx)(ee.a,{style:{fill:"red",fontSize:50}})})})]})}),Object(y.jsx)("div",{className:"sidebar box",children:Object(y.jsx)(N,{vsmVars:D,collapseDevToolComp:C,setCollapseDevToolComp:w,infoLogContents:d})}),Object(y.jsx)("div",{className:"inform box",children:Object(y.jsx)("div",{className:"",children:Object(y.jsx)("h2",{children:m})})}),Object(y.jsx)("div",{className:"content box",children:Object(y.jsx)(G,{inputSheetFieldDetails:f,setUserSubmittedInfo:V,updateUserSubmittedInfo:function(e,t){var n=Object(s.a)({},U);n[e]=t,V(n)},sendSubmit:function(){for(var e=0;e<f.variable.length;e++){var t=f.variable[e];"radio"===f.type[e]||"text"===f.type[e]||"number"===f.type[e]?U.hasOwnProperty(t)&&$.send("VSMMessage#VAR#".concat(t,"#").concat(U[t])):"checkbox"===f.type[e]&&U.hasOwnProperty(t)&&$.send("VSMMessage#VAR#".concat(t,"#").concat(U[t]))}$.send("VSMMessage#VAR#request_result#SUBMIT"),v({action:"SUCCESSFULSEND",timestamp:f.timestamp}),V(new Map)},sendCancel:function(){$.send("VSMMessage#VAR#request_result#CANCEL"),c(!1),j({}),V({}),v({}),p("")},userSubmittedInfo:U,infoLogContents:d})})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(y.jsx)(te,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[144,1,2]]]);
//# sourceMappingURL=main.4e4e39a0.chunk.js.map